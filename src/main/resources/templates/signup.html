<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Multi‚ÄëRole Sign Up</title>
  <link rel="stylesheet" href="/css/signup.css">
</head>
<body class="grain">
  <header class="page-head">
    <div class="head-inner">
      <a class="brand" href="#">
        <div class="brand-mark">ü§ù</div>
        <div class="brand-title">Sign Up</div>
      </a>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="card-head">
        <div>
          <h1 class="card-title">Create your account</h1>
          <p class="card-sub">Choose a role and fill the basics. No extra steps needed.</p>
        </div>
      </div>

      <div class="card-body">
        <form id="signupForm" autocomplete="off">
          <!-- Role choice -->
          <div>
            <div class="roles">
              <button type="button" class="btn role-btn role-active" data-role="Volunteer">Volunteer</button>
              <button type="button" class="btn role-btn" data-role="Donor">Donor</button>
              <button type="button" class="btn role-btn" data-role="PickUpAgent">Pick‚Äëup Agent</button>
              <button type="button" class="btn role-btn" data-role="NGO">NGO</button>
            </div>
            <div id="roleHelp" class="hint">Selected: Volunteer</div>
            <input type="hidden" id="role" name="role" value="Volunteer"/>
          </div>

          <!-- Basic User details -->
          <div class="form-grid">
            <div class="form-group">
              <label for="first_name">First name</label>
              <input id="first_name" name="first_name" required placeholder="Jane"/>
            </div>
            <div class="form-group">
              <label for="last_name">Last name</label>
              <input id="last_name" name="last_name" required placeholder="Doe"/>
            </div>
            <div class="form-group">
              <label for="middle_name">Middle name (optional)</label>
              <input id="middle_name" name="middle_name" placeholder="Ann"/>
            </div>
            <div class="form-group">
              <label for="username">Username</label>
              <input id="username" name="username" required placeholder="jane_doe123"/>
            </div>
            <div class="form-group">
              <label for="email">Email</label>
              <input id="email" name="email" type="email" required placeholder="jane@example.com"/>
            </div>
            <div class="form-group">
              <label for="phone_number">Phone number</label>
              <input id="phone_number" name="phone_number" type="tel" required placeholder="+1 555 123 4567"/>
            </div>
            <div class="form-group">
              <label for="city">City</label>
              <input id="city" name="city" required placeholder="San Francisco"/>
            </div>
            <div class="form-group">
              <label for="apartment">Apartment (optional)</label>
              <input id="apartment" name="apartment" placeholder="Apt 4B"/>
            </div>
            <div class="form-group full">
              <label for="street_address">Street address</label>
              <input id="street_address" name="street_address" required placeholder="123 Market St"/>
            </div>
            
          </div>

          <!-- NGO section -->
          <div id="section-NGO" class="section hidden-max">
            <div class="form-grid" style="margin-top:10px">
              <div class="form-group full">
                <label for="organization_name">Organization name</label>
                <input id="organization_name" name="organization_name" placeholder="Hope Foundation"/>
              </div>
              <div class="form-group full">
                <label>Accepted item types</label>
                <div id="accepted_items" class="chips">
                  <span class="chip" data-value="Clothes">Clothes</span>
                  <span class="chip" data-value="Toys">Toys</span>
                  <span class="chip" data-value="Food">Food</span>
                  <span class="chip" data-value="Funds">Funds</span>
                </div>
                <input type="hidden" id="accepted_item_types" name="accepted_item_types"/>
                <div class="hint">Tap to select multiple.</div>
              </div>
              <div class="form-group">
                <label for="upi_id">UPI ID (optional)</label>
                <input id="upi_id" name="upi_id" placeholder="name@bank"/>
              </div>
              <div class="form-group">
                <label for="bank_account">Bank account (optional)</label>
                <input id="bank_account" name="bank_account" placeholder="XXXXXXXXXXXX"/>
              </div>
              <div class="form-group">
                <label for="bank_name">Bank name (optional)</label>
                <input id="bank_name" name="bank_name" placeholder="Bank"/>
              </div>
              <div class="form-group">
                <label for="account_name">Account holder name (optional)</label>
                <input id="account_name" name="account_name" placeholder="Organization or Person"/>
              </div>
              <div class="form-group">
              <label for="registration_id">Registration ID</label>
              <input id="registration_id" name="registration_id" required placeholder="REG-12345"/>
             </div>
              <div class="form-group full">
                <label for="document_url">Document URL for verification</label>
                <input id="document_url" name="document_url" placeholder="https://example.com/doc.pdf"/>
                <div class="hint">Provide a URL to a verifiable document (e.g., registration certificate).</div>
              </div>
            </div>
          </div>

          <!-- PickUpAgent section -->
          <div id="section-PickUpAgent" class="section hidden-max">
            <div class="form-grid" style="margin-top:10px">
              <div class="form-group">
                <label for="vehicle_type">Vehicle type</label>
                <select id="vehicle_type" name="vehicle_type">
                  <option value="Bike">Bike</option>
                  <option value="Car">Car</option>
                  <option value="Premier Car">Car</option>
                  <option value="Truck Mini">Truck</option>
                  <option value="Truck Large">Car</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Volunteer section -->
          <div id="section-Volunteer" class="section visible-max">
          </div>
          <!-- Donor section -->
          <div id="section-Donor" class="section hidden-max">
          </div>

          <!-- Passwords -->
          <div class="form-grid">
            <div class="form-group">
              <label for="password">Create password</label>
              <input id="password" name="password" type="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>
            </div>
            <div class="form-group">
              <label for="confirm_password">Confirm password</label>
              <input id="confirm_password" name="confirm_password" type="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>
            </div>
          </div>

          <!-- Actions -->
          <div class="actions">
            <button type="submit" class="btn primary">Create account</button>
          </div>
        </form>
      </div>
    </section>
  </main>

  <script>
    // Role selection
    const roleInput = document.getElementById('role');
    const roleButtons = Array.from(document.querySelectorAll('.role-btn'));
    const sections = {
      Volunteer: document.getElementById('section-Volunteer'),
      Donor: document.getElementById('section-Donor'),
      PickUpAgent: document.getElementById('section-PickUpAgent'),
      NGO: document.getElementById('section-NGO'),
    };

    function showSection(role) {
      Object.entries(sections).forEach(([key, el]) => {
        if (key === role) {
          el.classList.remove('hidden-max');
          el.classList.add('visible-max');
        } else {
          el.classList.remove('visible-max');
          el.classList.add('hidden-max');
        }
      });
      roleButtons.forEach(btn => {
        if (btn.dataset.role === role) { btn.classList.add('role-active'); }
        else { btn.classList.remove('role-active'); }
      });
      roleInput.value = role;
      document.getElementById('roleHelp').textContent = `Selected: ${role}`;
    }

    roleButtons.forEach(btn => btn.addEventListener('click', () => showSection(btn.dataset.role)));

    // NGO chips
    const chipEls = Array.from(document.querySelectorAll('#accepted_items .chip'));
    const acceptedHidden = document.getElementById('accepted_item_types');
    chipEls.forEach(chip => {
      chip.addEventListener('click', () => {
        chip.classList.toggle('active');
        const selected = chipEls.filter(c => c.classList.contains('active')).map(c => c.getAttribute('data-value'));
        acceptedHidden.value = selected.join(',');
      });
    });

    // Submit
    document.getElementById('signupForm').addEventListener('submit', (e) => {
      e.preventDefault();

      const pwd = document.getElementById('password').value;
      const cpwd = document.getElementById('confirm_password').value;
      if (pwd.length < 8) { alert('Password must be at least 8 characters.'); return; }
      if (pwd !== cpwd) { alert('Passwords do not match.'); return; }

      // Build payload 
      const role = roleInput.value;
      const user = {
        first_name: document.getElementById('first_name').value.trim(),
        last_name: document.getElementById('last_name').value.trim(),
        middle_name: (document.getElementById('middle_name').value || '').trim() || null,
        username: document.getElementById('username').value.trim(),
        registration_id: document.getElementById('registration_id').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone_number: document.getElementById('phone_number').value.trim(),
        city: document.getElementById('city').value.trim(),
        street_address: document.getElementById('street_address').value.trim(),
        apartment: (document.getElementById('apartment').value || '').trim() || null,
        // Role mapping to fit your ENUMs
        user_type: (role === 'Donor') ? 'Donor' : 'Volunteer',
        role: (role === 'Donor') ? 'Donor' : 'Volunteer',
        password: pwd
      };

      const payload = { selected_signup_role: role, user };
      if (role === 'NGO') {
        payload.NGO = {
          organization_name: document.getElementById('organization_name').value.trim(),
          accepted_item_types: document.getElementById('accepted_item_types').value,
          upi_id: (document.getElementById('upi_id').value || '').trim() || null,
          bank_account: (document.getElementById('bank_account').value || '').trim() || null,
          bank_name: (document.getElementById('bank_name').value || '').trim() || null,
          account_name: (document.getElementById('account_name').value || '').trim() || null,
          document_url: document.getElementById('document_url').value.trim()
        };
      } else if (role === 'PickUpAgent') {
        payload.PickUpAgent = {
          vehicle_type: document.getElementById('vehicle_type').value
        };
      } else if (role === 'Donor') {
        payload.Donor = {
          donor_type: document.getElementById('donor_type')?.value || 'Individual',
          total_donated: parseFloat(document.getElementById('total_donated')?.value || '0')
        };
      }

      alert('Form submitted successfully!');
      // In a real app, you would send "payload" to your backend here.
      document.getElementById('signupForm').reset();
    });

    // Default role
    showSection('Volunteer');
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97ee0cdf66d2551c',t:'MTc1NzgzMzY3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>